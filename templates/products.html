{% extends "base.html" %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/products_style.css') }}">
{% endblock %}

{% block content %}
<section class="page-hero">
    <div class="container">
        <h1>{{ _("Our Products") }}</h1>
        <h2>{{ _("High-quality architectural details for every project") }}</h2>
    </div>
</section>

<section id="cladding-tile" class="section products-section">
    <div class="container">
        <div class="section-header">
            <h2 class="section-title">{{ _("Our exterior cladding tiles") }}</h2>
        </div>
        
        <div class="products-grid">
            {% for product in products %}
            <div class="product-card" data-category="{{ product.category.get(current_language, 'all') if product.category else 'all' }}">
                <div class="product-image">
                    <img 
                        src="{{ url_for('static', filename='img/placeholder.png') }}" 
                        data-src="{{ product.Images_folder_url }}" 
                        alt="{{ product.title.get('en') }}" 
                        loading="lazy" 
                        decoding="async" 
                        class="lazyload"
                        width="400" height="300">
                    <div class="product-overlay">
                        <a href="{{ url_for('product_detail', product_id=product._id) }}" class="btn-view">{{ _("View Details") }}</a>
                    </div>
                </div>
                <div class="product-info">
                    <h3>{{ product.title.get(current_language, product.title.get('en', '')) }}</h3>
                    <p>{{ product.description.get(current_language, product.description.get('en', ''))[:120] }}...</p>
                    <a href="{{ url_for('product_detail', product_id=product._id) }}" class="btn-text">{{ _("Learn more") }} <i class="fas fa-arrow-right"></i></a>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>

<section class="section cta bg-dark">
    <div class="container">
        <div class="cta-content">
            <h2>{{ _("Can't Find What You're Looking For?") }}</h2>
            <p>{{ _("We specialize in custom solutions. Contact us to discuss your specific requirements.") }}</p>
            <a href="{{ url_for('contact') }}" class="btn-primary">{{ _("Request Custom Quote") }}</a>
        </div>
    </div>
</section>

<script>
    // Fallback for browsers without native lazyload
    document.addEventListener("DOMContentLoaded", function() {
        if ('loading' in HTMLImageElement.prototype) {
            const images = document.querySelectorAll('img.lazyload');
            images.forEach(img => {
                img.src = img.dataset.src;
            });
        } else {
            const script = document.createElement('script');
            script.src = "https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.3.2/lazysizes.min.js";
            document.body.appendChild(script);
        }
    });
</script>
{% endblock %}
